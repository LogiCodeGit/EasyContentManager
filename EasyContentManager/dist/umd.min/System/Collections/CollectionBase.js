/*!
 * @author electricessence / https://github.com/electricessence/
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 */
!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports","./Enumeration/Enumerator","../Compare","../Exceptions/ArgumentNullException","../Exceptions/InvalidOperationException","../Disposable/DisposableBase","../Types","../../extends"],e)}(function(e,t){"use strict";var o=e("./Enumeration/Enumerator"),i=e("../Compare"),n=e("../Exceptions/ArgumentNullException"),r=e("../Exceptions/InvalidOperationException"),a=e("../Disposable/DisposableBase"),s=e("../Types"),u=e("../../extends"),p=u["default"],d="CollectionBase",l="Cannot modify a disposed collection.",f="Cannot modify a read-only collection.",c="resolve",y="../../System.Linq/Linq",h=function(t){function a(e,o){void 0===o&&(o=i.areEqual),t.call(this),this._equalityComparer=o;var n=this;n._disposableObjectName=d,n._importEntries(e),n._updateRecursion=0,n._modifiedCount=0,n._version=0}return p(a,t),Object.defineProperty(a.prototype,"count",{get:function(){return this.getCount()},enumerable:!0,configurable:!0}),a.prototype.getIsReadOnly=function(){return!1},Object.defineProperty(a.prototype,"isReadOnly",{get:function(){return this.getIsReadOnly()},enumerable:!0,configurable:!0}),a.prototype.assertModifiable=function(){if(this.throwIfDisposed(l),this.getIsReadOnly())throw new r.InvalidOperationException(f)},a.prototype.assertVersion=function(e){if(e!=this._version)throw new r.InvalidOperationException("Collection was modified.")},a.prototype._onModified=function(){},a.prototype._signalModification=function(e){var t=this;if(e&&t._modifiedCount++,t._modifiedCount&&!this._updateRecursion){t._modifiedCount=0,t._version++;try{t._onModified()}catch(o){console.error(o)}return!0}return!1},a.prototype._incrementModified=function(){this._modifiedCount++},Object.defineProperty(a.prototype,"isUpdating",{get:function(){return 0!=this._updateRecursion},enumerable:!0,configurable:!0}),a.prototype.handleUpdate=function(e){if(!e)return!1;var t=this;t.assertModifiable(),t._updateRecursion++;var o=!1;try{(o=e())&&t._modifiedCount++}finally{t._updateRecursion--}return t._signalModification(),o},a.prototype.add=function(e){var t=this;t.assertModifiable(),t._updateRecursion++;try{t._addInternal(e)&&t._modifiedCount++}finally{t._updateRecursion--}t._signalModification()},a.prototype.remove=function(e,t){void 0===t&&(t=1/0);var o=this;o.assertModifiable(),o._updateRecursion++;var i;try{(i=o._removeInternal(e,t))&&o._modifiedCount++}finally{o._updateRecursion--}return o._signalModification(),i},a.prototype.clear=function(){var e=this;e.assertModifiable(),e._updateRecursion++;var t;try{(t=e._clearInternal())&&e._modifiedCount++}finally{e._updateRecursion--}return e._signalModification(),t},a.prototype._onDispose=function(){t.prototype._onDispose.call(this),this._clearInternal(),this._version=0,this._updateRecursion=0,this._modifiedCount=0;var e=this._linq;this._linq=null,e&&e.dispose()},a.prototype._importEntries=function(e){var t=this,i=0;if(e)if(Array.isArray(e))for(var n=0,r=e;n<r.length;n++){var a=r[n];this._addInternal(a)&&i++}else o.forEach(e,function(e){t._addInternal(e)&&i++});return i},a.prototype.importEntries=function(e){var t=this;t.assertModifiable(),t._updateRecursion++;var o;try{(o=t._importEntries(e))&&t._modifiedCount++}finally{t._updateRecursion--}return t._signalModification(),o},a.prototype.contains=function(e){if(!this.getCount())return!1;var t=!1,o=this._equalityComparer;return this.forEach(function(i){return!(t=o(e,i))}),t},a.prototype.forEach=function(e,t){if(!t)return o.forEach(this.getEnumerator(),e);var i=this.toArray();try{return o.forEach(i,e)}finally{i.length=0}},a.prototype.copyTo=function(e,t){if(void 0===t&&(t=0),!e)throw new n.ArgumentNullException("target");var o=this.getCount(),i=o+t;e.length<i&&(e.length=i);for(var r=this.getEnumerator();r.moveNext();)e[t++]=r.current;return e},a.prototype.toArray=function(){var e=this.getCount();return this.copyTo(e>65536?new Array(e):[])},Object.defineProperty(a.prototype,"linq",{get:function(){if(s.Type.hasMember(e,c)&&1==e.length){var t=this._linq;return t||(this._linq=t=e(y)["default"].from(this)),t}throw".linq currently only supported within CommonJS.\nImport System.Linq/Linq and use Enumerable.from(e) instead."},enumerable:!0,configurable:!0}),a}(a.DisposableBase);t.CollectionBase=h});
//# sourceMappingURL=CollectionBase.js.map
